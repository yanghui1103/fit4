<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="roleSql">
	<sql id="paginationSql">
		<![CDATA[ and rn >#{start_num} and rn <= #{end_num} ]]>   
	</sql>
	<select id="getAccountIdByName"  parameterType="String" resultType="account">
		select * from t_account where isdeleted='0' and logname= #{logName,jdbcType=VARCHAR}
	</select>
	<select id="get"  parameterType="String" resultType="tAuthority">
		select * from t_authority where code = #{code,jdbcType=VARCHAR} and isdeleted='1'
	</select>
		
	<select id="getAuthoritysByRole"  parameterType="String" resultType="tAuthority">
		select a.* from t_role2authority  ra ,t_authority a 
		where ra.authorityid = a.code  and a.isdeleted='0' and ra.roleid = #{roleId}
	</select>	
	
	<select id="getMenusByRole"  parameterType="String" resultType="menu">
		select m.id,m.parentid,m.title,m.isdeleted,m.icon,m.href,m.opened from t_menu m,t_role2menu rm 
		where rm.menuid = m.id and m.isdeleted='0'  and rm.roleid =#{roleId} order by m.id asc
	</select>
	
	
	<select id="getRoles" parameterType="tRole" resultType="tRole">
		select * from (
		select a.*,rownum rn from t_role a where 1=1 and a.isdeleted ='0' 
		and ( a.name like '%'||#{keyWords,jdbcType=VARCHAR}||'%'
 		or a.desp like '%'||#{keyWords,jdbcType=VARCHAR}||'%' ) order by versionTime desc
 		) cc where 1=1  		
		<if test="paginationEnable!='0'.toString()">		
			<include refid="paginationSql"></include>
		</if>
	</select>
</mapper>   